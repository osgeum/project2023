Pod Scheduling

Node Selector ( 레이블을 통하여 노드를 선택하여 파드 실행 )

tensorflow-gpu.yaml
apiVersion: v1
kind: Pod
metadata:
  name: tensorflow-gpu
spec:
  containers:
  - name: tensorflow
  image: tensorflow/tensorflow:nightly-jupyter
  ports:
  - containerPort: 8888
    protocol: TCP
  nodeSelector:
    gpu: "true"

Affinity & antiAffinity ( node, pod에 적용 가능 )

nodeAffinity
노드의 특정 집합에만 pod를 스케줄 하도록 지시
nodeSelector: selector field에 명시된 모든 LABEL이 포함되어야 배치됨
nodeAffinity: 특정 노드에만 포드가 실행되도록 유도
nodAffinity 요구 조건
   엄격한 요구: requiredDuringschedulingIgnoredDuringExecultion ( nodeSelector와 동일 )
   선호도 요규: preferredDuringSchedulingIgnoredDuringExecution 
            ( 선호도, 조건에 맞는 조건에 가중치 붙여준후 가중치가 높은 노드에 파드 실행) 
apiVersion: v1
kind: Pod
metadata:
  name: tensorflow-gpu
spec:
  affinity:
    nodeAffinity:
	  requiredDuringschedulingIgnoredDuringExecultion:
        nodeSelectorTerms:
        - matchExpressions:
          - {key: disktype, operator: In, values:["ssd"]}
      preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 10
        preference:
          matchExpressions:
            - {key: gpu, operator: In, value: ["true"]}
              {key: disktype, operator: In, value: ["ssd"]}			
  containers:
  - name: tensorflow
  image: tensorflow/tensorflow:nightly-jupyter
  ports:
  - containerPort: 8888
    protocol: TCP

PodAffinity                                                            
nodeAffinity: 특정 노드에만 포드가 실행되도록 유도
nodAffinity 요구 조건
   엄격한 요구: requiredDuringschedulingIgnoredDuringExecultion ( nodeSelector와 동일 )
   선호도 요규: preferredDuringSchedulingIgnoredDuringExecution 
            ( 선호도, 조건에 맞는 조건에 가중치 붙여준후 가중치가 높은 노드에 파드 실행)
topologyKey
- 노드 label을 이용해 pod의 affinity와 antiaffinity를 설정 할수 있는 또하나의 기준.			
- 쿠버네티스는 Pod를 스케쥴링 할때 먼저 Pod의 label을 기존으로 대상 노드를 찾고, 이후 topologyKey 필드를 확인해 
  해당 노드가 원하는 노드인지 확인.


taint & toleration


cordon & drain